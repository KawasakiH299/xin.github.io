<!DOCTYPE html>
<html lang="en"><head>
    <title>KawasakiH299 Blog</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#000084" />
    <link rel="icon" href="https://baidu.com/favicon.ico">
    <link rel="canonical" href="https://baidu.com">
    
    
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"></button>
            <a class="brand" href="https://baidu.com">KawasakiH299 Blog</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    
                    
                        
                            <li>
                                <a href="/about/">
                                    
                                    <span>About</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/post/">
                                    
                                    <span>All posts</span>
                                </a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
    </div>
</nav><div id="content" class="container">

<div class="row-fluid navmargin">
    <div class="page-header">
        <h1>python读取各格式文件 - Thu, May 4, 2023</h1>
    </div>
    <p class="lead"></p>
    <p>实例</p>
<ul>
<li>Json</li>
</ul>
<pre tabindex="0"><code>import json

# 创建一个字典对象
data = {&#34;name&#34;: &#34;John&#34;, &#34;age&#34;: 30, &#34;city&#34;: &#34;New York&#34;}

# 将字典对象序列化为JSON格式的字符串
json_str = json.dumps(data)

# 将JSON格式的字符串写入文件中
with open(&#39;data.json&#39;, &#39;w&#39;) as f:
    f.write(json_str)
</code></pre><pre tabindex="0"><code>import json

# 从文件中读取 JSON 数据
with open(&#39;data.json&#39;, &#39;r&#39;) as f:
    data = json.load(f)

# 或者从字符串中读取 JSON 数据
json_str = &#39;{&#34;name&#34;: &#34;John&#34;, &#34;age&#34;: 30, &#34;city&#34;: &#34;New York&#34;}&#39;
data = json.loads(json_str)
</code></pre><ul>
<li>csv</li>
</ul>
<pre tabindex="0"><code>import csv

# 写入 CSV 文件
with open(&#39;data.csv&#39;, &#39;w&#39;, newline=&#39;&#39;) as f:
    writer = csv.writer(f)
    writer.writerow([&#39;name&#39;, &#39;age&#39;, &#39;city&#39;])
    writer.writerow([&#39;Bob&#39;, &#39;25&#39;, &#39;Shanghai&#39;])
    writer.writerow([&#39;Alice&#39;, &#39;30&#39;, &#39;New York&#39;])
</code></pre><pre tabindex="0"><code>import csv

# 从 CSV 文件中读取数据
with open(&#39;data.csv&#39;, &#39;r&#39;) as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)
</code></pre><ul>
<li>文本文件（<code>.txt</code>）</li>
</ul>
<p>文本文件是最常见的文件类型之一，通常用于保存纯文本数据。在 Python 中，可以使用内置函数 <code>open()</code> 和 <code>write()</code> 来创建并写入文本文件：</p>
<pre tabindex="0"><code>pythonCopy Code# 创建并写入文本文件
with open(&#39;file.txt&#39;, &#39;w&#39;) as f:
    f.write(&#39;Hello, world!&#39;)
</code></pre><p>上述代码将创建一个名为 <code>file.txt</code> 的文本文件，并向其中写入字符串 <code>'Hello, world!'</code>。</p>
<ul>
<li>CSV 文件（<code>.csv</code>）</li>
</ul>
<p>CSV 文件是一种逗号分隔的文本文件，通常用于存储表格数据。在 Python 中，可以使用标准库中的 <code>csv</code> 模块来读取和写入 CSV 文件：</p>
<pre tabindex="0"><code>pythonCopy Codeimport csv

# 写入 CSV 文件
with open(&#39;file.csv&#39;, &#39;w&#39;, newline=&#39;&#39;) as f:
    writer = csv.writer(f)
    writer.writerow([&#39;Name&#39;, &#39;Age&#39;])
    writer.writerow([&#39;John&#39;, 30])
    writer.writerow([&#39;Alice&#39;, 25])

# 读取 CSV 文件
with open(&#39;file.csv&#39;, &#39;r&#39;) as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)
</code></pre><p>上述代码将创建一个名为 <code>file.csv</code> 的 CSV 文件，并向其中写入表格数据。通过 <code>csv.reader()</code> 方法可以逐行读取该文件的内容，并返回一个包含每行数据的列表。</p>
<ul>
<li>JSON 文件（<code>.json</code>）</li>
</ul>
<p>JSON 文件是一种轻量级的数据交换格式，通常用于存储结构化数据。在 Python 中，可以使用标准库中的 <code>json</code> 模块来读取和写入 JSON 文件：</p>
<pre tabindex="0"><code>pythonCopy Codeimport json

# 写入 JSON 文件
data = {&#39;name&#39;: &#39;John&#39;, &#39;age&#39;: 30}
with open(&#39;file.json&#39;, &#39;w&#39;) as f:
    json.dump(data, f)

# 读取 JSON 文件
with open(&#39;file.json&#39;, &#39;r&#39;) as f:
    data = json.load(f)
    print(data)
</code></pre><p>上述代码将创建一个名为 <code>file.json</code> 的 JSON 文件，并向其中写入包含字典对象的 JSON 数据。通过 <code>json.load()</code> 方法可以读取该文件的内容，并返回反序列化后的 Python 对象。</p>
<ol>
<li>Excel 文件（<code>.xlsx</code>、<code>.xls</code>）</li>
</ol>
<p>Excel 文件是一种常见的电子表格文件格式，通常用于存储和处理大量数据。在 Python 中，可以使用第三方库 <code>openpyxl</code> 来读取和写入 Excel 文件：</p>
<pre tabindex="0"><code>pythonCopy Codeimport openpyxl

# 创建并写入 Excel 文件
wb = openpyxl.Workbook()
ws = wb.active
ws[&#39;A1&#39;] = &#39;Name&#39;
ws[&#39;B1&#39;] = &#39;Age&#39;
ws[&#39;A2&#39;] = &#39;John&#39;
ws[&#39;B2&#39;] = 30
ws[&#39;A3&#39;] = &#39;Alice&#39;
ws[&#39;B3&#39;] = 25
wb.save(&#39;file.xlsx&#39;)

# 读取 Excel 文件
wb = openpyxl.load_workbook(&#39;file.xlsx&#39;)
ws = wb.active
for row in ws.iter_rows(values_only=True):
    print(row)
</code></pre><pre tabindex="0"><code>html = &#34;&#34;&#34;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;

&lt;h1&gt;My First Heading&lt;/h1&gt;

&lt;p&gt;My first paragraph.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
&#34;&#34;&#34;

# 保存HTML文件
with open(&#39;example.html&#39;, &#39;w&#39;) as f:
    f.write(html)
</code></pre><p>上述代码将创建一个包含简单标题和段落的HTML代码，并将其写入名为<code>example.html</code>的文件中。</p>
<p>然后，我们可以使用相同的文件对象和<code>read()</code>方法来读取该文件：</p>
<pre tabindex="0"><code>pythonCopy Code# 读取HTML文件
with open(&#39;example.html&#39;, &#39;r&#39;) as f:
    html = f.read()

print(html)
</code></pre>
    <h4><a href="https://baidu.com"></a></h4>
</div>


        </div><footer class="container">
    <hr class="soften">

    <p class="text-center">
        <a href="https://facebook.com">Facebook</a> 
        <a href="https://twitter.com">Twitter</a> 
        <a href="https://linkedin.com">Linkedin</a> 
        <a href="https://github.com">GitHub</a> 
        <a href="https://gitlab.com">GitLab</a>
    </p>
</footer>

</body><link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/bootstrap-responsive.css">
<link rel="stylesheet" href="/css/style.css">

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap-386.js"></script>
<script src="/js/bootstrap-transition.js"></script>
<script src="/js/bootstrap-alert.js"></script>
<script src="/js/bootstrap-modal.js"></script>
<script src="/js/bootstrap-dropdown.js"></script>
<script src="/js/bootstrap-scrollspy.js"></script>
<script src="/js/bootstrap-tab.js"></script>
<script src="/js/bootstrap-tooltip.js"></script>
<script src="/js/bootstrap-popover.js"></script>
<script src="/js/bootstrap-button.js"></script>
<script src="/js/bootstrap-collapse.js"></script>
<script src="/js/bootstrap-carousel.js"></script>
<script src="/js/bootstrap-typeahead.js"></script>
<script src="/js/bootstrap-affix.js"></script>
<script>
    _386 = { 
        fastLoad: false ,
        onePass: false , 
        speedFactor: 1 
    };

    
    function ThisYear() {
        document.getElementById('thisyear').innerHTML = new Date().getFullYear();
    };
</script>
</html>
